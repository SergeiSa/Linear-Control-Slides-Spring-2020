\documentclass{article}
\usepackage[utf8]{inputenc}

\title{Controllability }
\author{Ahmad Hamdan }
\date{May 2020}

\usepackage{natbib}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[framed,numbered,autolinebreaks,useliterate]{mcode}

\begin{document}

\maketitle

\section{Introduction}
A natural question arises in linear control theory: To what extent can closed-loop feedback $ u=-K x$ manipulate the behavior of the system $ \dot x=Ax + Bu $. 
In this lecture we will provide concrete conditions on when the system can be controllable and we will provide some examples.


\section{Controllability}
The ability to design the eigenvalues of the closed-loop system with the choice of \textbf{K} relies on the system in $ \dot x=Ax + Bu $ being \textit{controllable}. The controllability of a linear system is determined entirely by the column space of the \textbf{controllability} matrix \textbf{C}: 
\begin{equation}
    \textbf{C}
    =
    \begin{bmatrix}
B& AB& A^2B& ... &A^{n-1}B
\end{bmatrix}
\end{equation}
If the matrix \textbf{C} has $n$ linearly independent columns, so that it spans all of $R^n$ then the system $ \dot x=Ax + Bu $ is controllable. The span of the columns of the controllability matrix \textbf{C} forms a Krylov subspace that determines which state vector directions in $R^n$ may be manipulated with control. Thus, in addition to controllability  implying arbitrary eigenvalue placement, it also implies that any state $\xi \in R^n$
is reachable in a finite time with some actuation signal $u(t)$.
The following three conditions are equivalent:
\begin{enumerate}
    \item \textit{Controllability.} The span of \textbf{C} is $R^n$. The matrix \textbf{C} may be generated by \begin{lstlisting} 
    ctrb(A,B)
    \end{lstlisting}
    and and the rank may be tested to see if it is equal to $n$, by 
    \begin{lstlisting} 
    rank(ctrb(A,B))
    \end{lstlisting}
    
    \item \textit{Arbitrary eigenvalue placement.} It is possible to design the eigenvalues of the closed-loop system through choice of feedback $u=-Kx$: 
    \begin{equation}
        \frac{d}{dt} x = Ax + Bu = (A-BK)x
    \end{equation}
    Given a set of desired eigenvalues, the gain K can be determined by
    \begin{lstlisting}
    K=place(A,B,neweig);
    \end{lstlisting}
    
    \item \textit{Reachability of $R^n$}. It is possible to steer the system to any arbitrary state $x(t)= \xi \in R^n$ in a finite time with some actuation signal $u(t)$.
\end{enumerate}
Note that reachability also applies to open-loop systems. In particular, if a direction $\xi$ is not in the span of \textbf{C}, then it is impossible for control to push in this direction in either open-loop or closed-loop.
\newline
\newline
\textbf{Examples.} The notion of controllability is more easily understood by investigating a few simple examples. First, consider the following system 
\begin{equation}
  \frac{d}{dt}   
  \begin{bmatrix}
  x_1 \\ x_2
  \end{bmatrix}
  =
  \begin{bmatrix}
  1&0\\
  0&2
  \end{bmatrix}
  \begin{bmatrix}
  x_1\\
  x_2
  \end{bmatrix}
  +
  \begin{bmatrix}
  0\\
  1
  \end{bmatrix}
  u
  \Rightarrow 
  \textbf{C} = 
  \begin{bmatrix}
  0&0\\
  1&2
  \end{bmatrix}
\end{equation}
This system is not controllable, because the controllability matrix \textbf{C} consists of two linearly dependent vectors and does not span $R^n$. Even before checking the rank of the controllability matrix, it is easy to see that the system wonâ€™t be controllable since the states $x_1$ and  $x_2$ are completely decoupled and the actuation input $u$ only effects the second state.
\newline
Modifying this example to include two actuation inputs makes the system controllable by increasing the control authority:
\begin{equation}
  \frac{d}{dt}   
  \begin{bmatrix}
  x_1 \\ x_2
  \end{bmatrix}
  =
  \begin{bmatrix}
  1&0\\
  0&2
  \end{bmatrix}
  \begin{bmatrix}
  x_1\\
  x_2
  \end{bmatrix}
  +
  \begin{bmatrix}
  1&0\\
  0&1
  \end{bmatrix}
  \begin{bmatrix}
  u_1\\
  u_2
  \end{bmatrix}
  \Rightarrow 
  \textbf{C} = 
  \begin{bmatrix}
  1&0&1&0\\
  0&1&0&2
  \end{bmatrix}
\end{equation}
This \textit{fully actuated} system is clearly controllable because $x_1$ and $x_2$ may be independently controlled with $u_1$ and $u_2$ The controllability of this system is confirmed by checking that the columns of \textbf{C} do span $R^n$.
\newline 
The most interesting cases are less obvious than these two examples. Consider the system
\begin{equation}
  \frac{d}{dt}   
  \begin{bmatrix}
  x_1 \\ x_2
  \end{bmatrix}
  =
  \begin{bmatrix}
  1&1\\
  0&2
  \end{bmatrix}
  \begin{bmatrix}
  x_1\\
  x_2
  \end{bmatrix}
  +
  \begin{bmatrix}
  0\\
  1
  \end{bmatrix}
  u
  \Rightarrow 
  \textbf{C} = 
  \begin{bmatrix}
  0&1\\
  1&2
  \end{bmatrix}
\end{equation}
This two-state system is controllable with a single actuation input because the states $x_1$ and $x_2$ are now coupled through the dynamics. Similarly, 
\begin{equation}
  \frac{d}{dt}   
  \begin{bmatrix}
  x_1 \\ x_2
  \end{bmatrix}
  =
  \begin{bmatrix}
  1&0\\
  0&2
  \end{bmatrix}
  \begin{bmatrix}
  x_1\\
  x_2
  \end{bmatrix}
  +
  \begin{bmatrix}
  1\\
  1
  \end{bmatrix}
  u
  \Rightarrow 
  \textbf{C} = 
  \begin{bmatrix}
  1&1\\
  1&2
  \end{bmatrix}
\end{equation}
is controllable even though the dynamics of $x_1$ and $x_2$ are decoupled, because the actuator $ \textbf{B} = \begin{bmatrix}
  1 & 1
\end{bmatrix}^T$ 
is able to simultaneously affect both states and they have different timescales. 
\newline Further you will see that controllability is intimately related to the alignment of the columns of \textbf{B} with the eigenvector directions of \textbf{A}.
\section{References}
\begin{enumerate}
    \item Data-Driven Science and Engineering: Machine Learning, Dynamical Systems, and Control by J. Nathan Kutz and Steven L. Brunton
    \item https://www.youtube.com/watch?v=u5Sv7YKAkt4&list=PLMrJAkhIeNNR20Mz-VpzgfQs5zrYi085m&index=5
    \item Control Engineering Fifth Edition by Katsuhiko Ogata
\end{enumerate}
\end{document}

